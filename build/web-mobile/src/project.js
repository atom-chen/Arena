window.__require=function e(t,o,n){function r(a,c){if(!o[a]){if(!t[a]){var u=a.split("/");if(u=u[u.length-1],!t[u]){var s="function"==typeof __require&&__require;if(!c&&s)return s(u,!0);if(i)return i(u,!0);throw new Error("Cannot find module '"+a+"'")}a=u}var l=o[a]={exports:{}};t[a][0].call(l.exports,function(e){return r(t[a][1][e]||e)},l,l.exports,e,t,o,n)}return o[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<n.length;a++)r(n[a]);return r}({Battle:[function(e,t,o){"use strict";cc._RF.push(t,"61554KOp7NB2Y3wx0SenNKj","Battle"),Object.defineProperty(o,"__esModule",{value:!0});var n,r,i=e("./Hero"),a=e("../utils/Utils"),c=e("./HeroType"),u=e("./Global"),s=e("../utils/Event");(function(e){e[e.Draw=0]="Draw",e[e.Defeat=1]="Defeat",e[e.Victory=2]="Victory"})(n=o.BattleResult||(o.BattleResult={})),function(e){e[e.Prepare=0]="Prepare",e[e.Battle=1]="Battle",e[e.Finish=2]="Finish"}(r=o.BattleState||(o.BattleState={}));var l=function(){return function(){this.firstLine=[],this.secondLine=[]}}();o.BattleSide=l;var h=function(){function e(){this.sides=[new l,new l],this.state=r.Prepare,this.onFinish=new s.Event}return e.create=function(){var t=new e,o=Array.from({length:c.HeroType.Count},function(e,t){return u.Global.m.config.heroCfgs[t]}),n=a.utils.splitArray(o,function(e){return e.classType});return Array.from({length:i.HeroSide.Count},function(e,o){var r=a.utils.shuffleArray(n[c.HeroClassType.Mellee]).slice(0,2),u=a.utils.shuffleArray(n[c.HeroClassType.Archer]).slice(0,3);t.sides[o].firstLine=r.map(function(e,t){return i.Hero.create(e.type,o,t)}),t.sides[o].secondLine=u.map(function(e,t){return i.Hero.create(c.HeroType.Archer,o,t)})}),cc.log("[BATTLE]",t),t},e.prototype.start=function(){var e=this;this.sides.forEach(function(t){return a.utils.flatten([t.firstLine,t.secondLine]).forEach(function(t){t.startBattle(),t.onDeath.add(e,function(){return e.checkFinish()})})}),this.state=r.Battle},e.prototype.whenWinish=function(e){this.onFinish.dispatch(e),this.state=r.Finish},e.prototype.checkFinish=function(){var e=this.sides.map(function(e){return a.utils.flatten([e.firstLine,e.secondLine]).every(function(e){return e.killed})});1==e[0]&&1==e[1]?this.whenWinish(n.Draw):1==e[0]?(this.whenWinish(n.Defeat),cc.log("[BATTLE][LOSE]")):1==e[1]&&(cc.log("[BATTLE][WIN]"),this.whenWinish(n.Victory))},e}();o.Battle=h,cc._RF.pop()},{"../utils/Event":"Event","../utils/Utils":"Utils","./Global":"Global","./Hero":"Hero","./HeroType":"HeroType"}],Config:[function(e,t,o){"use strict";cc._RF.push(t,"2015eL9lENAi6lHQE1LZbdm","Config"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../utils/Jsonable"),r=e("../utils/Loader"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.fromJson=function(e){var o=new t;return o.fromJson(e),o},t.create=function(e,t){var o=this.fromJson(e);return o.type=t,o},__decorate([n.jp("c")],t.prototype,"classType",void 0),__decorate([n.jp("h")],t.prototype,"health",void 0),__decorate([n.jp("n")],t.prototype,"name",void 0),__decorate([n.jp("d")],t.prototype,"damage",void 0),__decorate([n.jp("dl")],t.prototype,"attackDelayMs",void 0),__decorate([n.jp("ud")],t.prototype,"ultDamage",void 0),__decorate([n.jp("udl")],t.prototype,"ultDelayMs",void 0),t}(n.Jsonable);o.HeroCfg=i;var a=function(){function e(){}return e.prototype.init=function(){var e=this;return Promise.all([this.loadWithCb("Heroes",function(t){e.heroCfgs=t.map(function(e,t){return i.create(e,t)}),cc.log("[TEST] heroes",e.heroCfgs)})])},e.prototype.loadWithCb=function(e,t){return new Promise(function(o,n){r.Loader.loadConfig(e).then(function(e){t(e),o()}).catch(function(e){return n(e)})})},e}();o.Config=a,cc._RF.pop()},{"../utils/Jsonable":"Jsonable","../utils/Loader":"Loader"}],Event:[function(e,t,o){"use strict";cc._RF.push(t,"ecd23SHQphCBY8MJCA1Q78j","Event"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e,t,o){void 0===o&&(o=!1),this.once=o,this.owner=null,this.cbOnEvent=null,this.owner=e,this.cbOnEvent=t}return e.prototype.onEvent=function(e){this.cbOnEvent(e)},e}();o.EventHandler=n;var r=function(){function e(){this._events=new Array}return e.removeAll=function(t){var o=[];this._getChildsWithSubscribe(t,o),e._pool._events.forEach(function(e){e.handlers.length>0&&(e.handlers=e.handlers.filter(function(e){return null==o.find(function(t){return t==e.owner})}))})},e._getChildsWithSubscribe=function(e,t){var o=this;e.__useEvent&&t.push(e),e.children.forEach(function(e){return o._getChildsWithSubscribe(e,t)})},e.push=function(t){e._pool._events.push(t)},e._pool=new e,e}();o.EventPool=r;var i=function(){function e(e){this.result=null,this.handlers=new Array,r.push(this),this.result=e}return e.prototype.add=function(e,t,o){var r=this,i=e instanceof n?e:new n(e,t);if(e instanceof cc.Component){e.__useEvent=!0;var a=e.onDestroy;e.onDestroy=function(){r.handlers=r.handlers.filter(function(e){return e!=i}),a&&a.call(e)}}return this.handlers.push(i),this.result},e.prototype.replace=function(e,t){var o=this.handlers.find(function(t){return t.owner===e});return o?o.onEvent=t:this.handlers.push(new n(e,t)),this.result},e.prototype.dispatch=function(e){this.handlers.forEach(function(t){return t.onEvent(e)}),this.handlers=this.handlers.filter(function(e){return 0==e.once})},e.prototype.remove=function(e){this.handlers=this.handlers.filter(function(t){return t!=e})},e.prototype.removeAll=function(e){this.handlers=e?this.handlers.filter(function(t){return t.owner!=e}):[]},e.subscribeEventOnce=function(e,t){var o=new n(this,function(n){e.remove(o),t(n)});e.add(o)},e}();o.Event=i,cc._RF.pop()},{}],GameScene:[function(e,t,o){"use strict";cc._RF.push(t,"357eaeqmiZIr4wlQj51GU5B","GameScene"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../model/Global"),r=e("./game/GameToolbar"),i=e("../model/Hero"),a=e("../view/HeroView"),c=e("../utils/Utils"),u=e("./SceneType"),s=e("../model/Battle"),l=cc._decorator,h=l.ccclass,p=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.heroPrefab=null,t.leftSidePositions=new Array,t.rightSidePositions=new Array,t.gameToolbar=null,t.blackLayer=null,t.readyLabel=null,t.heroes=[],t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.blackLayer.node.opacity=255;var t=n.Global.m.createBattle(),o=t.sides[i.HeroSide.Left].firstLine.concat(t.sides[i.HeroSide.Left].secondLine),r=t.sides[i.HeroSide.Right].firstLine.concat(t.sides[i.HeroSide.Right].secondLine),u=[this.leftSidePositions,this.rightSidePositions],s=c.utils.flatten([o,r].map(function(t,o){return t.map(function(t,n){if(t){var r=cc.instantiate(e.heroPrefab);return r.position=u[o][n].position,u[o][n].parent.addChild(r),e.heroes.push(r.getComponent(a.default)),r.getComponent(a.default).setHero(t)}return null})}));s.push.apply(s,this.gameToolbar.setBattle(t)),Promise.all(s).then(function(){return e.startPreparing()})},t.prototype.startPreparing=function(){var e=this;this.heroes.forEach(function(t){return t.setAllHeroes(e.heroes)});cc.tween(this.blackLayer.node).to(.2,{opacity:0}).start(),cc.tween(this.readyLabel.node).delay(.2).call(function(){return e.readyLabel.string="3"}).to(.5,{scale:1.2}).to(.1,{scale:1}).call(function(){return e.readyLabel.string="2"}).to(.5,{scale:1.2}).to(.1,{scale:1}).call(function(){return e.readyLabel.string="1"}).to(.5,{scale:1.2}).to(.1,{scale:1}).call(function(){e.readyLabel.string="BATTLE!",e.startBattle()}).to(.75,{scale:1.2}).to(.25,{opacity:0}).start()},t.prototype.startBattle=function(){var e=this;n.Global.m.battle.onFinish.add(this,function(t){t==s.BattleResult.Victory?e.readyLabel.string="VICTORY":t==s.BattleResult.Defeat?e.readyLabel.string="DEFEAT":e.readyLabel.string="DRAW",cc.tween(e.readyLabel.node).delay(.5).to(.5,{opacity:255,scale:1.2}).to(.2,{scale:1}).delay(2).call(function(){return cc.director.loadScene(u.SceneType.Menu)}).start()}),n.Global.m.battle.start()},t.prototype.onCloseButton=function(){cc.director.loadScene(u.SceneType.Menu)},__decorate([p(cc.Prefab)],t.prototype,"heroPrefab",void 0),__decorate([p([cc.Node])],t.prototype,"leftSidePositions",void 0),__decorate([p([cc.Node])],t.prototype,"rightSidePositions",void 0),__decorate([p(r.default)],t.prototype,"gameToolbar",void 0),__decorate([p(cc.Sprite)],t.prototype,"blackLayer",void 0),__decorate([p(cc.Label)],t.prototype,"readyLabel",void 0),t=__decorate([h],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../model/Battle":"Battle","../model/Global":"Global","../model/Hero":"Hero","../utils/Utils":"Utils","../view/HeroView":"HeroView","./SceneType":"SceneType","./game/GameToolbar":"GameToolbar"}],GameToolbar:[function(e,t,o){"use strict";cc._RF.push(t,"17ba6Tnf4tNhbX4d8U+XFug","GameToolbar"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../model/Hero"),r=e("../../view/HeroButtonNode"),i=cc._decorator,a=i.ccclass,c=i.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonsNode=null,t.buttonPrefab=null,t}return __extends(t,e),t.prototype.setBattle=function(e){var t=this;return e.sides[n.HeroSide.Left].firstLine.concat(e.sides[n.HeroSide.Left].secondLine).map(function(e,o){var n=cc.instantiate(t.buttonPrefab);return t.buttonsNode.addChild(n),n.getComponent(r.default).setHero(e)})},t.prototype.onButton=function(e,t){var o=+t;cc.log("[ON HERO]",o)},__decorate([c(cc.Node)],t.prototype,"buttonsNode",void 0),__decorate([c(cc.Prefab)],t.prototype,"buttonPrefab",void 0),t=__decorate([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../../model/Hero":"Hero","../../view/HeroButtonNode":"HeroButtonNode"}],Global:[function(e,t,o){"use strict";cc._RF.push(t,"6e3fcfQhXdMqorczYFh7F7o","Global"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./Config"),r=e("./Battle"),i=function(){function e(){this.config=new n.Config}return e.prototype.init=function(){return Promise.all([this.config.init()]).then(function(){cc.log("[TEST]")})},Object.defineProperty(e,"timeMS",{get:function(){return(new Date).getTime()},enumerable:!0,configurable:!0}),e.prototype.createBattle=function(){return this.battle=r.Battle.create(),this.battle},e}();o.Global=i,cc._RF.pop()},{"./Battle":"Battle","./Config":"Config"}],HeroButtonNode:[function(e,t,o){"use strict";cc._RF.push(t,"b9ff4ht1HVO+Zl44TPlijun","HeroButtonNode"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../utils/Event"),r=e("../utils/Loader"),i=e("../model/Global"),a=e("../model/Battle"),c=cc._decorator,u=c.ccclass,s=c.property,l=cc.color(79,105,185),h=cc.color(45,140,243),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bgNode=null,t.heroName=null,t.heroIcon=null,t.health=null,t.healthPg=null,t.ult=null,t.ultPg=null,t.onClick=new n.Event,t}return __extends(t,e),t.prototype.setHero=function(e){var t=this;return this._hero=e,this.heroName.string=e.name,this.updateHealthPg(),this.updateUltPg(),this._hero.onTakeDamage.add(this,function(){return t.updateHealthPg()}),this._hero.onDeath.add(this,function(){return t.whenDeath()}),r.Loader.loadTexture("monster"+(e.type+1)+"_ic").then(function(e){return t.heroIcon.spriteFrame=e})},t.prototype.updateHealthPg=function(){this.health.string=""+this._hero.health,this.healthPg.progress=this._hero.health/this._hero.fullHealth},t.prototype.updateUltPg=function(){var e=i.Global.m.battle.state==a.BattleState.Battle;this.ultPg.progress=this._hero.ultProgress;var t=this.ultPg.progress>=1;this.bgNode.color=t&&e?h:l,this.getComponent(cc.Button).enabled=e&&t,this.getComponent(cc.Button).interactable=e&&t},t.prototype.whenDeath=function(){this.bgNode.color=cc.color(36,38,42),this.getComponent(cc.Button).enabled=!1,this.getComponent(cc.Button).interactable=!1,this.update=function(e){}},t.prototype.onButton=function(){this.onClick.dispatch(this._hero),this._hero.ultHit()},t.prototype.update=function(e){this.updateUltPg()},__decorate([s(cc.Node)],t.prototype,"bgNode",void 0),__decorate([s(cc.Label)],t.prototype,"heroName",void 0),__decorate([s(cc.Sprite)],t.prototype,"heroIcon",void 0),__decorate([s(cc.Label)],t.prototype,"health",void 0),__decorate([s(cc.ProgressBar)],t.prototype,"healthPg",void 0),__decorate([s(cc.Label)],t.prototype,"ult",void 0),__decorate([s(cc.ProgressBar)],t.prototype,"ultPg",void 0),t=__decorate([u],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../model/Battle":"Battle","../model/Global":"Global","../utils/Event":"Event","../utils/Loader":"Loader"}],HeroType:[function(e,t,o){"use strict";cc._RF.push(t,"a6abektp3JDBamuP4qzzleq","HeroType"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.Mellee=0]="Mellee",e[e.Archer=1]="Archer",e[e.Sorcer=2]="Sorcer"}(o.HeroClassType||(o.HeroClassType={})),function(e){e[e.Archer=0]="Archer",e[e.Kent=1]="Kent",e[e.Roga4=2]="Roga4",e[e.Groot=3]="Groot",e[e.Zumba=4]="Zumba",e[e.Chuvirla=5]="Chuvirla",e[e.BabaYaga=6]="BabaYaga",e[e.Pushok=7]="Pushok",e[e.Rat=8]="Rat",e[e.Krilach=9]="Krilach",e[e.Pugach=10]="Pugach",e[e.Staruchka=11]="Staruchka",e[e.Egibtolog=12]="Egibtolog",e[e.Count=13]="Count"}(o.HeroType||(o.HeroType={})),cc._RF.pop()},{}],HeroView:[function(e,t,o){"use strict";cc._RF.push(t,"3af3c/EzUhILZNBY+l7vCFm","HeroView"),Object.defineProperty(o,"__esModule",{value:!0});var n,r=e("../model/Hero"),i=e("../utils/Loader"),a=e("../model/HeroType"),c=e("../model/Global"),u=cc._decorator,s=u.ccclass,l=u.property;(function(e){e.Stand="Stand",e.MainAttack="MainAttack"})(n||(n={}));var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.icon=null,t.health=null,t.healthBar=null,t}return __extends(t,e),t.prototype.setHero=function(e){var t=this;return e.side==r.HeroSide.Right&&(this.health.node.scaleX=-this.health.node.scaleX),this._hero=e,this.health.string=""+e.health,this.healthBar.progress=e.health/e.fullHealth,e.onTakeDamage.add(this,function(o){t.health.string=""+e.health,t.healthBar.progress=e.health/e.fullHealth}),e.onDeath.add(this,function(){return cc.tween(t.icon.node).to(.3,{angle:360,scale:.01,opacity:0}).call(function(){return t.node.destroy()}).start()}),e.onHit.add(this,function(e){var o=t._allHeroViews.find(function(t){return t._hero==e.o});if(o){var r=o.node.parent.convertToWorldSpaceAR(o.node.position);r.y-=50;var c=new cc.Node,u=["hit1/hit_anim5","archerHit"][t._hero.classType];i.Loader.loadTexture(u).then(function(e){return c.addComponent(cc.Sprite).spriteFrame=e}),t.node.addChild(c),c.opacity=0,c.x+=25,c.y+=35,cc.tween(c).delay(t._anim?.5:0).to(0,{opacity:255}).to(.5,{position:t.node.convertToNodeSpaceAR(cc.v2(r.x,r.y))}).to(.1,{opacity:0}).call(function(){return c.destroy()}).start(),t._hero.classType!=a.HeroClassType.Mellee||e.u||cc.tween(t.node).by(t._hero.attackDelayMs/2500,{position:cc.v2(100,0)}).by(t._hero.attackDelayMs/2500,{position:cc.v2(-100,0)}).start()}else cc.log("[HEROVIEW]","error can;t find view for: "+e.o);t._anim&&t._anim.play(n.MainAttack)}),c.Global.m.battle.onFinish.add(this,function(){return t._anim&&t._anim.play(n.Stand)}),this.loadHeroView(e)},t.prototype.loadHeroView=function(e){var t=this;return e.type==a.HeroType.Archer?i.Loader.loadNode("heroes/ArcherNode").then(function(e){t._anim=e.getComponent(cc.Animation),t._anim.play(n.Stand),t.icon.node.addChild(e)}):i.Loader.loadTexture("monster"+(e.type+1)).then(function(e){return t.icon.spriteFrame=e})},t.prototype.setAllHeroes=function(e){this._allHeroViews=e},t.prototype.update=function(e){this._hero&&(this._hero.timeFromUlt+=e)},__decorate([l(cc.Sprite)],t.prototype,"icon",void 0),__decorate([l(cc.Label)],t.prototype,"health",void 0),__decorate([l(cc.ProgressBar)],t.prototype,"healthBar",void 0),t=__decorate([s],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../model/Global":"Global","../model/Hero":"Hero","../model/HeroType":"HeroType","../utils/Loader":"Loader"}],Hero:[function(e,t,o){"use strict";cc._RF.push(t,"0144dnWE8pK86qv9hf23fKo","Hero"),Object.defineProperty(o,"__esModule",{value:!0});var n,r=e("./Global"),i=e("../utils/Event"),a=e("./Battle");(function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Count=2]="Count"})(n=o.HeroSide||(o.HeroSide={}));var c=function(){function e(){this.timeFromUlt=Number.MAX_VALUE,this.onDeath=new i.Event,this.onHit=new i.Event,this.onTakeDamage=new i.Event}return Object.defineProperty(e.prototype,"killed",{get:function(){return this.health<=0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullHealth",{get:function(){return this.config.health},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classType",{get:function(){return this.config.classType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"damage",{get:function(){return this.config.damage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.config.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ultProgress",{get:function(){return Math.min(1,1e3*this.timeFromUlt/this.config.ultDelayMs)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attackDelayMs",{get:function(){return 2.5*this.config.attackDelayMs},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){this.config=r.Global.m.config.heroCfgs[this.type]},e.create=function(t,o,n){var r=new e;return r.type=t,r.getConfig(),r.health=r.config.health,r.side=o,r.position=n,r},e.prototype.getDamage=function(e,t){var o=this.health;this.health=Math.max(0,this.health-(t?e.config.ultDamage:e.damage)),this.health<=0&&this.onDeath.dispatch(),this.onTakeDamage.dispatch({was:o})},e.prototype.startBattle=function(){this.hit()},e.prototype.hit=function(e){var t=this;if(void 0===e&&(e=!1),this.killed)cc.log("[HERO][KILLED]");else{var o=r.Global.m.battle.sides[n.Right-this.side],i=[o.firstLine[this.position%2],o.firstLine[(1-this.position)%2],o.secondLine[this.position],o.secondLine[(this.position+1)%3],o.secondLine[(this.position+2)%3]].find(function(e){return e&&!e.killed});i&&(this.onHit.dispatch({o:i,u:e}),i.getDamage(this,e),e||setTimeout(function(){t.hit()},this.attackDelayMs))}},e.prototype.ultHit=function(){this.killed||r.Global.m.battle.state!=a.BattleState.Battle||1e3*this.timeFromUlt<this.config.ultDelayMs||(this.timeFromUlt=0,this.hit(!0))},e}();o.Hero=c,cc._RF.pop()},{"../utils/Event":"Event","./Battle":"Battle","./Global":"Global"}],Jsonable:[function(e,t,o){"use strict";cc._RF.push(t,"917dbMF1axFnrO0iYr70OSA","Jsonable"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.get=function(e,t){return null!=e?e:t},e}();function r(e,t,o){return function(n,r){n.addJsonableElement(e||r,r,t,o)}}o.Json=n,o.jp=r,o.jarray=function(e,t,o){return void 0===o&&(o=[]),function(n,r){n.addJsonableArray(e,r,o,t)}};var i=function(){function e(e,t,o){this.key=e,this._default=t,this.type=o}return e.prototype.default=function(e){return void 0!==this._default?"function"==typeof this._default?this._default(e):this._default:void 0},e}(),a=function(){return function(e,t,o){this.key=e,this.default=t,this.type=o}}(),c=function(){function e(){}return e.prototype.addJsonableElement=function(e,t,o,n){this.addJsonable(e,t,o,"_jValues",n)},e.prototype.addJsonableArray=function(e,t,o,n){this.addJsonable(e,t,o,"_jArrays",n)},e.prototype.addJsonable=function(e,t,o,n,r){var c=this,u="_jArrays"==n;null==Object.getOwnPropertyDescriptor(this,n)&&(this[n]=new Map),u?this[n].set(e,new a(t,o,r)):this[n].set(e,new i(t,o,r));var s=Object.getPrototypeOf(this)[n];s&&s.forEach(function(e,t){c[n].has(t)||c[n].set(t,e)})},e.prototype._createIfTypeExist=function(e){this[e.key]||void 0==e.type||(this[e.key]=new e.type)},e.prototype._tryFromJson=function(e,t){return!(!this[e.key]||!this[e.key].fromJson)&&(this[e.key].fromJson(t),!0)},e.prototype._computeArrays=function(e,t){var o=this;return this._jArrays&&this._jArrays.forEach(function(n,r){void 0!==e[r]?(o[n.key]=[],e[r].forEach(function(e){var t=new n.type(e);"function"==typeof t&&t&&(t=new t),void 0===t&&cc.log("[FROM JSON] undefined class to create for:",e),o[n.key].push(t),o[n.key][o[n.key].length-1].fromJson(e)})):t&&(o[n.key]=n.default)}),this},e.prototype._computeValues=function(e,t){var o=this;return this._jValues&&this._jValues.forEach(function(n,r){var i=e[r];void 0!==i?(o._createIfTypeExist(n),o._tryFromJson(n,i)||(o[n.key]=i)):t&&(o[n.key]=n.default(o))}),this},e.prototype.fromJson=function(e){return e&&this._computeValues(e,!0)._computeArrays(e,!0),this},e.prototype.updateByJson=function(e){return e&&this._computeValues(e,!1)._computeArrays(e,!1),this},e.prototype.toJson=function(){var e=this,t={};return this._jValues&&this._jValues.forEach(function(o,n){e[o.key]&&e[o.key].toJson?1!=e[o.key].dontSave&&(t[n]=e[o.key].toJson()):void 0!=e[o.key]&&(t[n]=e[o.key])}),this._jArrays&&this._jArrays.forEach(function(o,n){return e[o.key]&&(t[n]=e[o.key].map(function(e){return e.toJson()}))}),t},e.prototype.toJsonString=function(){return JSON.stringify(this.toJson())},e}();o.Jsonable=c,function(e){var t=function(e){function t(t,o){void 0===t&&(t=0),void 0===o&&(o=0);var n=e.call(this)||this;return n.x=t,n.y=o,n}return __extends(t,e),t.prototype.update=function(e,t){this.x=e,this.y=t},t.prototype.checkEq=function(e){return this.x==e.x&&this.y==e.y},Object.defineProperty(t.prototype,"fastDist",{get:function(){return this.x*this.x+this.y*this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dist",{get:function(){return Math.sqrt(this.fastDist)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"v2",{get:function(){return cc.v2(this.x,this.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zero",{get:function(){return 0==this.x&&0==this.y},enumerable:!0,configurable:!0}),__decorate([r()],t.prototype,"x",void 0),__decorate([r()],t.prototype,"y",void 0),t}(c);e.Vec2=t}(o.JP||(o.JP={})),cc._RF.pop()},{}],LoadScene:[function(e,t,o){"use strict";cc._RF.push(t,"b13c8PAl+tAcJ8wrHzcO1Wi","LoadScene"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../model/Global"),r=e("./SceneType"),i=cc._decorator,a=i.ccclass,c=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.start=function(){var e=this;n.Global.m=new n.Global,n.Global.m.init().then(function(){return e.toMenuScene()}).catch(function(e){return cc.log("[LOAD GAME CRUSHSHSH]",e)})},t.prototype.toMenuScene=function(){cc.director.loadScene(r.SceneType.Menu)},t=__decorate([a],t)}(cc.Component));o.default=c,cc._RF.pop()},{"../model/Global":"Global","./SceneType":"SceneType"}],Loader:[function(e,t,o){"use strict";cc._RF.push(t,"a9030xuM2lCI6Zg4IkqvARP","Loader"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.loadNode=function(e,t){return void 0===t&&(t=!0),this.loadRes("prefabs/"+e).then(function(e){return t?cc.instantiate(e):e})},e.loadRes=function(e){return new Promise(function(t,o){cc.loader.loadRes(""+e,function(n,r){n?(cc.log("no res for: "+e),o(n)):t(r)})})},e.loadConfig=function(e){return this.loadRes("cfg/"+e).then(function(e){return e.json})},e.loadTexture=function(e){return new Promise(function(t,o){cc.loader.loadRes("textures/"+e,cc.SpriteFrame,function(n,r){n?(cc.log("no texture",e),o(n)):t(r)})})},e.loadTextureFromAtlas=function(e,t){var o=this;return new Promise(function(n,r){o.loadAtlas(e).then(function(e){n(e.getSpriteFrame(t))})})},e.loadAtlas=function(e){return new Promise(function(t,o){return cc.loader.loadRes("textures/"+e,cc.SpriteAtlas,function(n,r){n?(cc.log("[LOADER] error load atlass",e),o(n)):(cc.log("[ATLAS LOAD]",e,n),t(r))})})},e}();o.Loader=n,cc._RF.pop()},{}],MenuScene:[function(e,t,o){"use strict";cc._RF.push(t,"4f2b6tpgDhNRYx2KK6o7GSR","MenuScene"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../view/menu/MenuToolbarNode"),r=e("./SceneType"),i=e("../view/menu/MenuToolbarNodeType"),a=cc._decorator,c=a.ccclass,u=a.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pageView=null,t.pageViewContentNode=null,t.toolbar=null,t.savedSize=new cc.Size(0,0),t.pageState=i.MenuToolbarNodeType.Play,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.toolbar.onClick.add(this,function(t){return e.pageView.setCurrentPageIndex(t)}),this.savedSize=this.node.getContentSize(),this.updateNonWidgetSize()},t.prototype.start=function(){this.pageView.setCurrentPageIndex(this.pageState)},t.prototype.onPlayButton=function(){cc.director.loadScene(r.SceneType.Game)},t.prototype.update=function(e){this.savedSize.width!=this.node.width&&(this.savedSize=this.node.getContentSize(),this.updateNonWidgetSize())},t.prototype.updateNonWidgetSize=function(){var e=this;this.toolbar.node.children.forEach(function(t){return t.width=e.node.width/e.toolbar.node.childrenCount-6}),this.pageViewContentNode.children.forEach(function(t){return t.width=e.node.width}),cc.tween(this.pageView.node).delay(.05).call(function(){return e.pageView.setCurrentPageIndex(e.pageState)}).start()},t.prototype.onPageViewIndexCahnged=function(e,t){this.pageState=this.pageView.getCurrentPageIndex(),this.toolbar.animateButton(this.pageState)},__decorate([u(cc.PageView)],t.prototype,"pageView",void 0),__decorate([u(cc.Node)],t.prototype,"pageViewContentNode",void 0),__decorate([u(n.default)],t.prototype,"toolbar",void 0),t=__decorate([c],t)}(cc.Component);o.default=s,cc._RF.pop()},{"../view/menu/MenuToolbarNode":"MenuToolbarNode","../view/menu/MenuToolbarNodeType":"MenuToolbarNodeType","./SceneType":"SceneType"}],MenuToolbarNodeType:[function(e,t,o){"use strict";cc._RF.push(t,"25803qhoPFLza1RWeg+T99O","MenuToolbarNodeType"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.Shop=0]="Shop",e[e.Play=1]="Play",e[e.Guild=2]="Guild",e[e.Count=3]="Count"}(o.MenuToolbarNodeType||(o.MenuToolbarNodeType={})),cc._RF.pop()},{}],MenuToolbarNode:[function(e,t,o){"use strict";cc._RF.push(t,"f980eHc36pHvKJG5JMUOaZI","MenuToolbarNode"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../utils/Event"),r=cc._decorator,i=r.ccclass,a=r.property,c=cc.color(79,105,185),u=cc.color(45,140,243),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.onClick=new n.Event,t}return __extends(t,e),t.prototype.onButton=function(e,t){var o=+t;this.onClick.dispatch(o),this.animateButton(o)},t.prototype.animateButton=function(e){this.node.children.forEach(function(t,o){return t.children.forEach(function(t){return t.color=o==e?u:c})})},__decorate([a(cc.Label)],t.prototype,"label",void 0),t=__decorate([i],t)}(cc.Component);o.default=s,cc._RF.pop()},{"../../utils/Event":"Event"}],SceneType:[function(e,t,o){"use strict";cc._RF.push(t,"ac4121x205F0pRJDN8+w/Y0","SceneType"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e.Game="Game",e.Load="Load",e.Menu="Menu"}(o.SceneType||(o.SceneType={})),cc._RF.pop()},{}],Utils:[function(e,t,o){"use strict";cc._RF.push(t,"a89aamG74dNZq4vfK+MOlHp","Utils"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){function t(e,t){void 0===t&&(t=e,e=0);var o=Math.abs(t-e),n=Math.floor(1e5*Math.random()%(o+1));return t>e?e+n:e-n}function o(e){return e[e.length-1]}e.randInt=t,e.randFromArray=function(e){return e[t(e.length-1)]},e.buttonHandler=function(e,t,o){var n=new cc.Component.EventHandler;return n.target=e,n.component=t,n.handler=o,n},e.shuffleArray=function(e){for(var o=Array.from({length:e.length},function(e,t){return t}),n=[];o.length>0;){var r=t(o.length-1),i=o[r];n.push(e[i]),o=o.slice(0,r).concat(o.slice(r+1))}return n},e.getSubArrays=function(e,t){return Array.from({length:Math.ceil(e.length/t)},function(o,n){return e.slice(n*t,n*t+t)})},e.flatten=function(e){return e.reduce(function(e,t){return e.concat(t)},[])},e.copyInstance=function(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)},e.runFunction=function(e,t){for(var o=0;o<t;o++)e(o)},e.applyOnAllChildren=function e(t,o){t.children.forEach(function(t){o(t),e(t,o)})},e.getColor=function(e){return e.startsWith("der")?cc.Color.BLUE:e.startsWith("die")?cc.Color.RED:e.startsWith("das")?cc.Color.GREEN:cc.Color.BLACK},e.splitArray=function(e,t){return e.map(function(e){return{t:e,s:t(e)}}).sort(function(e,t){return e.s-t.s}).reduce(function(e,t){return e.length>0&&o(e)[0].s==t.s?o(e).push(t):e.push([t]),e},new Array).map(function(e){return e.map(function(e){return e.t})})},e.last=o,e.zip=function(e,t){return e.length>=t.length?e.map(function(e,o){return{left:e,right:t[o]}}):t.map(function(t,o){return{left:e[o],right:t}})},e.onlyUniq=function(e,t){void 0===t&&(t=function(e,t){return e==t});var o=[];return e.forEach(function(e){void 0==o.find(function(o){return t(o,e)})&&o.push(e)}),o},e.FileSave=function(e,t){var o=document.createElement("a");if(!("download"in o))throw"File saving not supported for this browser";o.href="data:text/plaincharset=utf-8,"+escape(e),o.setAttribute("download",t),document.body.appendChild(o);var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(n),document.body.removeChild(o)},e.vecToDegree=function(e){var t=e.normalize();return 180*Math.atan2(t.x,t.y)/Math.PI-90}}(o.utils||(o.utils={})),cc._RF.pop()},{}]},{},["Battle","Config","Global","Hero","HeroType","GameScene","LoadScene","MenuScene","SceneType","GameToolbar","Event","Jsonable","Loader","Utils","HeroButtonNode","HeroView","MenuToolbarNode","MenuToolbarNodeType"]);